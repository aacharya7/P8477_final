% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={COVID Age Structured Model},
  pdfauthor={Anna Huang},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{COVID Age Structured Model}
\author{Anna Huang}
\date{4/8/2021}

\begin{document}
\maketitle

\textbf{Age Structured Model Without Seasonal Forcing}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(deSolve)}
\NormalTok{COVID=}\ControlFlowTok{function}\NormalTok{(times,state,parameters)\{}
  \KeywordTok{with}\NormalTok{(}\KeywordTok{as.list}\NormalTok{(}\KeywordTok{c}\NormalTok{(state,parameters)),\{}
  \CommentTok{#age 0-15}
\NormalTok{    dS1 =}\StringTok{ }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{1}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{S1;}
\NormalTok{    dE1 =}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{1}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{1}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{E1;}
\NormalTok{    dA1 =}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{A1;}
\NormalTok{    dM1 =}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{1}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{1}\NormalTok{])}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{M1;}
\NormalTok{    dH1 =}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{H1;}
\NormalTok{    dR1 =}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{1}\NormalTok{])}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{*}\StringTok{ }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{R1;}
\NormalTok{    dC1 =}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{C1;}
\NormalTok{    dDead1 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1;}
\NormalTok{    dcumInci1 =}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{alpha;}
  \CommentTok{#age 15-29}
\NormalTok{    dS2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{S1 }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{2}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{S2;}
\NormalTok{    dE2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{E1 }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{2}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{2}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{E2;}
\NormalTok{    dA2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{A1 }\OperatorTok{+}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{A2;}
\NormalTok{    dM2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{2}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{2}\NormalTok{])}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{M2;}
\NormalTok{    dH2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{H2;}
\NormalTok{    dR2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{R1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{2}\NormalTok{])}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{R2;}
\NormalTok{    dC2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{C2;}
\NormalTok{    dDead2 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2;}
\NormalTok{    dcumInci2 =}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{alpha;}
  \CommentTok{#age 30-59}
\NormalTok{    dS3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{S2 }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{3}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{S3;}
\NormalTok{    dE3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{E2 }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{3}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{3}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{E3;}
\NormalTok{    dA3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{A2 }\OperatorTok{+}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{A3;}
\NormalTok{    dM3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{+}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{3}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{3}\NormalTok{])}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{M3;}
\NormalTok{    dH3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{H3;}
\NormalTok{    dR3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{R2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{3}\NormalTok{])}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{R3;}
\NormalTok{    dC3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{C3;}
\NormalTok{    dDead3 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3;}
\NormalTok{    dcumInci3 =}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{alpha;}
  \CommentTok{#age 59+}
\NormalTok{    dS4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{S3 }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{4}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{4}\NormalTok{];}
\NormalTok{    dE4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{E3 }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{4}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{n[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{4}\NormalTok{]));}
\NormalTok{    dA4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{A3 }\OperatorTok{+}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A4;}
\NormalTok{    dM4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{+}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{4}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{M4 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{4}\NormalTok{])}\OperatorTok{*}\NormalTok{M4;}
\NormalTok{    dH4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{+}\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{M4 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4;}
\NormalTok{    dR4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{R3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A4 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{4}\NormalTok{])}\OperatorTok{*}\NormalTok{M4 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4;}
\NormalTok{    dC4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4;}
\NormalTok{    dDead4 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4;}
\NormalTok{    dcumInci4 =}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{alpha;}
    
          \CommentTok{# return the rate of change}
    \KeywordTok{list}\NormalTok{(}\KeywordTok{c}\NormalTok{(dS1, dS2, dS3, dS4, dE1, dE2, dE3, dE4, dA1, dA2, dA3, dA4, dM1, dM2, dM3, dM4, dH1, dH2, dH3, dH4, dR1, dR2, dR3, dR4, dC1, dC2, dC3, dC4, dDead1, dDead2, dDead3, dDead4, dcumInci1, dcumInci2,dcumInci3,dcumInci4))}
\NormalTok{  \}) }\CommentTok{# end with(as.list...)}
\NormalTok{\}}

\NormalTok{l1 =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\DecValTok{15}\OperatorTok{*}\DecValTok{365}\NormalTok{); }\CommentTok{#15 years}
\NormalTok{l2 =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\DecValTok{29}\OperatorTok{*}\DecValTok{365}\NormalTok{) }\CommentTok{#29 years}
\NormalTok{l3 =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\DecValTok{59}\OperatorTok{*}\DecValTok{365}\NormalTok{) }\CommentTok{#59 years}
\NormalTok{N=}\DecValTok{8500000}\NormalTok{;}
\NormalTok{n=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.19}\NormalTok{, }\FloatTok{0.23}\NormalTok{, }\FloatTok{0.43}\NormalTok{, }\FloatTok{0.15}\NormalTok{);}
\NormalTok{A0=}\KeywordTok{c}\NormalTok{(}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{);}
\NormalTok{M0=}\KeywordTok{c}\NormalTok{(}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{);}
\NormalTok{E0=H0=cumInci0=C0=R0=Dead0=}\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{4}\NormalTok{);}
\NormalTok{S0=N}\OperatorTok{*}\NormalTok{n}\OperatorTok{-}\NormalTok{A0}\OperatorTok{-}\NormalTok{M0;}
  
\NormalTok{beta1 =}\StringTok{ }\FloatTok{1.12} \CommentTok{#peak infection}
\NormalTok{alpha =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\FloatTok{3.69} \CommentTok{#latent period}
\NormalTok{gamma =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\FloatTok{3.47} \CommentTok{#infectious period}
\NormalTok{rho =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.03}\NormalTok{,}\FloatTok{0.06}\NormalTok{,}\FloatTok{0.09}\NormalTok{,}\FloatTok{0.12}\NormalTok{) }\CommentTok{#proportion progressing to severe infection}
\NormalTok{mu =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\FloatTok{78.7}\OperatorTok{*}\DecValTok{365}\NormalTok{) }\CommentTok{#birth/death rate = 1/life expectancy in days}
\NormalTok{theta =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.95}\NormalTok{,}\FloatTok{0.9}\NormalTok{,}\FloatTok{0.85}\NormalTok{,}\FloatTok{0.8}\NormalTok{) }\CommentTok{#proportion asymptomatic}
\NormalTok{kappa_h =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.1}\OperatorTok{/}\DecValTok{11}\NormalTok{,}\FloatTok{0.13}\OperatorTok{/}\DecValTok{11}\NormalTok{,}\FloatTok{0.16}\OperatorTok{/}\DecValTok{13}\NormalTok{,}\FloatTok{0.19}\OperatorTok{/}\DecValTok{13}\NormalTok{) }\CommentTok{#proportion of severe to critical infection}
\NormalTok{gamma_h =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.9}\OperatorTok{/}\DecValTok{4}\NormalTok{,}\FloatTok{0.87}\OperatorTok{/}\DecValTok{4}\NormalTok{,}\FloatTok{0.84}\OperatorTok{/}\DecValTok{6}\NormalTok{,}\FloatTok{0.81}\OperatorTok{/}\DecValTok{6}\NormalTok{) }\CommentTok{#proportion of severe to recovered}
\NormalTok{kappa_c =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.35}\OperatorTok{/}\DecValTok{5}\NormalTok{,}\FloatTok{0.25}\OperatorTok{/}\DecValTok{5}\NormalTok{,}\FloatTok{0.15}\OperatorTok{/}\DecValTok{6}\NormalTok{,}\FloatTok{0.05}\OperatorTok{/}\DecValTok{6}\NormalTok{) }\CommentTok{#proportion of critical back to severe infection}
\NormalTok{sigma =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.65}\OperatorTok{/}\DecValTok{9}\NormalTok{,}\FloatTok{0.75}\OperatorTok{/}\DecValTok{9}\NormalTok{,}\FloatTok{0.85}\OperatorTok{/}\DecValTok{10}\NormalTok{,}\FloatTok{0.95}\OperatorTok{/}\DecValTok{10}\NormalTok{) }\CommentTok{#proportion of critical to recovered}
\NormalTok{omega =}\StringTok{ }\DecValTok{2}\OperatorTok{*}\NormalTok{pi}\OperatorTok{/}\DecValTok{365} \CommentTok{#sinusoidal forcing}
\NormalTok{times=}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{365}\NormalTok{,}\DataTypeTok{by=}\DecValTok{1}\NormalTok{) }

\CommentTok{#beta matrix}
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.606148 4.803074 3.202049 2.401537
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.7}\OperatorTok{*}\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6.724304 3.362152 2.241435 1.681076
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5055867 0.5336749 0.5650675 0.6003842
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\FloatTok{2.5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4.803074 2.401537 1.601025 1.200768
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.7}\OperatorTok{*}\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\FloatTok{2.5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.3621518 1.6810759 1.1207173 0.8405379
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\FloatTok{2.5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2527934 0.2668374 0.2825338 0.3001921
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{beta=}\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{4.80}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{0.84}\NormalTok{,}
              \FloatTok{1.68}\NormalTok{,}\FloatTok{2.40}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}
              \FloatTok{1.12}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.60}\NormalTok{,}\FloatTok{2.24}\NormalTok{,}
              \FloatTok{0.84}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{1.20}\NormalTok{),}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DataTypeTok{byrow=}\NormalTok{T)}
\NormalTok{Nmatrix=}\KeywordTok{diag}\NormalTok{(n,}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{);}
\NormalTok{r0=}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Nmatrix }\OperatorTok{%*%}\StringTok{ }\NormalTok{beta)}\OperatorTok{$}\NormalTok{values[}\DecValTok{1}\NormalTok{]}
\NormalTok{b =}\StringTok{ }\FloatTok{2.5}\OperatorTok{/}\NormalTok{r0}\OperatorTok{*}\NormalTok{gamma}
\NormalTok{BETA=}\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{4.80}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{0.84}\NormalTok{,}
              \FloatTok{1.68}\NormalTok{,}\FloatTok{2.40}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}
              \FloatTok{1.12}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.60}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}
              \FloatTok{0.84}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{1.20}\NormalTok{),}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DataTypeTok{byrow=}\NormalTok{T)}\OperatorTok{*}\NormalTok{b}

\NormalTok{state=}\KeywordTok{c}\NormalTok{(}\DataTypeTok{S1=}\NormalTok{S0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{S2=}\NormalTok{S0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{S3=}\NormalTok{S0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{S4=}\NormalTok{S0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{E1=}\NormalTok{E0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{E2=}\NormalTok{E0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{E3=}\NormalTok{E0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{E4=}\NormalTok{E0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{A1=}\NormalTok{A0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{A2=}\NormalTok{A0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{A3=}\NormalTok{A0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{A4=}\NormalTok{A0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{M1=}\NormalTok{A0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{M2=}\NormalTok{M0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{M3=}\NormalTok{M0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{M4=}\NormalTok{M0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{H1=}\NormalTok{A0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{H2=}\NormalTok{H0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{H3=}\NormalTok{H0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{H4=}\NormalTok{H0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{R1=}\NormalTok{R0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{R2=}\NormalTok{R0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{R3=}\NormalTok{R0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{R4=}\NormalTok{R0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{C1=}\NormalTok{C0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{C2=}\NormalTok{C0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{C3=}\NormalTok{C0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{C4=}\NormalTok{C0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{Dead1=}\NormalTok{Dead0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{Dead2=}\NormalTok{Dead0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{Dead3=}\NormalTok{Dead0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{Dead4=}\NormalTok{Dead0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{cumInci1=}\NormalTok{cumInci0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{cumInci2=}\NormalTok{cumInci0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{cumInci3=}\NormalTok{cumInci0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{cumInci4=}\NormalTok{cumInci0[}\DecValTok{4}\NormalTok{])}

\NormalTok{parameters=}\KeywordTok{c}\NormalTok{(}\DataTypeTok{BETA=}\NormalTok{BETA,}\DataTypeTok{mu=}\NormalTok{mu,}\DataTypeTok{gamma=}\NormalTok{gamma,}\DataTypeTok{alpha=}\NormalTok{alpha,}\DataTypeTok{rho=}\NormalTok{rho,}\DataTypeTok{theta=}\NormalTok{theta,}\DataTypeTok{kappa_h=}\NormalTok{kappa_h,}\DataTypeTok{gamma_h=}\NormalTok{gamma_h,}\DataTypeTok{kappa_c=}\NormalTok{kappa_c,}
             \DataTypeTok{sigma=}\NormalTok{sigma,}\DataTypeTok{omega=}\NormalTok{omega,}\DataTypeTok{N=}\NormalTok{N,}\DataTypeTok{beta1=}\NormalTok{beta1)    }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{COVID.sim=}\KeywordTok{ode}\NormalTok{(}\DataTypeTok{y=}\NormalTok{state,}\DataTypeTok{times=}\NormalTok{times,}\DataTypeTok{func=}\NormalTok{COVID,}\DataTypeTok{parms=}\NormalTok{parameters)}
\NormalTok{inci1=COVID.sim[}\KeywordTok{seq}\NormalTok{(}\DecValTok{7}\NormalTok{,}\KeywordTok{nrow}\NormalTok{(COVID.sim),}\DataTypeTok{by=}\DecValTok{7}\NormalTok{),}\StringTok{'cumInci1'}\NormalTok{] }\CommentTok{#weekly incidence}

\CommentTok{#plot}
\KeywordTok{plot}\NormalTok{(inci1,}\DataTypeTok{ylab=}\StringTok{'Weekly Incidence'}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{'Week'}\NormalTok{,}\DataTypeTok{type=}\StringTok{'l'}\NormalTok{,}\DataTypeTok{lwd=}\DecValTok{1}\NormalTok{, }\DataTypeTok{main=}\StringTok{"Weekly Documented Incidence of COVID over 1 Year"}\NormalTok{,}\DataTypeTok{col=}\StringTok{'blue'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{COVID-Age-Structured-Model_files/figure-latex/unnamed-chunk-2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{matplot}\NormalTok{(COVID.sim[,}\StringTok{'time'}\NormalTok{], COVID.sim[,}\KeywordTok{c}\NormalTok{(}\StringTok{'S1'}\NormalTok{,}\StringTok{'S2'}\NormalTok{,}\StringTok{'S3'}\NormalTok{,}\StringTok{'S4'}\NormalTok{)],}\DataTypeTok{type=}\StringTok{'l'}\NormalTok{, }
        \DataTypeTok{lwd=}\DecValTok{1}\NormalTok{,}\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{'blue'}\NormalTok{,}\StringTok{'red'}\NormalTok{,}\StringTok{'green'}\NormalTok{,}\StringTok{'purple'}\NormalTok{),}\DataTypeTok{lty=}\DecValTok{1}\NormalTok{, }\DataTypeTok{main=}\StringTok{'Susceptibility Over 1 Year with Age Structured Model'}\NormalTok{, }\DataTypeTok{cex.main=}\DecValTok{1}\NormalTok{,}
        \DataTypeTok{ylab=}\StringTok{'Number of People'}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{'Time (days)'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{COVID-Age-Structured-Model_files/figure-latex/unnamed-chunk-2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{matplot}\NormalTok{(COVID.sim[,}\StringTok{'time'}\NormalTok{], COVID.sim[,}\KeywordTok{c}\NormalTok{(}\StringTok{'A1'}\NormalTok{,}\StringTok{'A2'}\NormalTok{,}\StringTok{'A3'}\NormalTok{,}\StringTok{'A4'}\NormalTok{,}\StringTok{'M1'}\NormalTok{,}\StringTok{'M2'}\NormalTok{,}\StringTok{'M2'}\NormalTok{,}\StringTok{'M3'}\NormalTok{,}\StringTok{'M4'}\NormalTok{)],}\DataTypeTok{type=}\StringTok{'l'}\NormalTok{, }
        \DataTypeTok{lwd=}\DecValTok{1}\NormalTok{,}\DataTypeTok{col=}\KeywordTok{c}\NormalTok{(}\StringTok{'blue'}\NormalTok{,}\StringTok{'red'}\NormalTok{,}\StringTok{'green'}\NormalTok{,}\StringTok{'purple'}\NormalTok{,}\StringTok{'orange'}\NormalTok{,}\StringTok{'cyan'}\NormalTok{,}\StringTok{'brown'}\NormalTok{,}\StringTok{'black'}\NormalTok{),}\DataTypeTok{lty=}\DecValTok{1}\NormalTok{, }\DataTypeTok{main=}\StringTok{'Incidence Over 1 Year with Age Structure Model'}\NormalTok{,         }\DataTypeTok{cex.main=}\DecValTok{1}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{'Number of People'}\NormalTok{,}\DataTypeTok{xlab=}\StringTok{'Time (days)'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{COVID-Age-Structured-Model_files/figure-latex/unnamed-chunk-2-3.pdf}

\textbf{Age Structured Model With Seasonal Forcing}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(deSolve)}
\NormalTok{COVID=}\ControlFlowTok{function}\NormalTok{(times,state,parameters)\{}
  \KeywordTok{with}\NormalTok{(}\KeywordTok{as.list}\NormalTok{(}\KeywordTok{c}\NormalTok{(state,parameters)),\{}
  \CommentTok{#age 0-15}
\NormalTok{    dS1 =}\StringTok{ }\NormalTok{mu}\OperatorTok{*}\NormalTok{N }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{1}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{S1;}
\NormalTok{    dE1 =}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{1}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{1}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{E1;}
\NormalTok{    dA1 =}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{1}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{A1;}
\NormalTok{    dM1 =}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{1}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{1}\NormalTok{])}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{M1;}
\NormalTok{    dH1 =}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{H1;}
\NormalTok{    dR1 =}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{1}\NormalTok{])}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{*}\StringTok{ }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{R1;}
\NormalTok{    dC1 =}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{-}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{C1;}
\NormalTok{    dDead1 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{C1;}
\NormalTok{    dcumInci1 =}\StringTok{ }\NormalTok{E1}\OperatorTok{*}\NormalTok{alpha;}
  \CommentTok{#age 15-29}
\NormalTok{    dS2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{S1 }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{2}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{S2;}
\NormalTok{    dE2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{E1 }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{2}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{2}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{E2;}
\NormalTok{    dA2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{A1 }\OperatorTok{+}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{2}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{A2;}
\NormalTok{    dM2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{2}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{2}\NormalTok{])}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{M2;}
\NormalTok{    dH2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{H1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{H2;}
\NormalTok{    dR2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{R1 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{2}\NormalTok{])}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{1}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{R2;}
\NormalTok{    dC2 =}\StringTok{ }\NormalTok{l1}\OperatorTok{*}\NormalTok{C1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{-}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{C2;}
\NormalTok{    dDead2 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{C2;}
\NormalTok{    dcumInci2 =}\StringTok{ }\NormalTok{E2}\OperatorTok{*}\NormalTok{alpha;}
  \CommentTok{#age 30-59}
\NormalTok{    dS3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{S2 }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{3}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{S3;}
\NormalTok{    dE3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{E2 }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{3}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{3}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{E3;}
\NormalTok{    dA3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{A2 }\OperatorTok{+}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{3}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{A3;}
\NormalTok{    dM3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{M2 }\OperatorTok{+}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{3}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{3}\NormalTok{])}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{M3;}
\NormalTok{    dH3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{H2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{M1 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{H3;}
\NormalTok{    dR3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{R2 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{3}\NormalTok{])}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{R3;}
\NormalTok{    dC3 =}\StringTok{ }\NormalTok{l2}\OperatorTok{*}\NormalTok{C2 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{-}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{C3;}
\NormalTok{    dDead3 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{3}\NormalTok{]}\OperatorTok{*}\NormalTok{C3;}
\NormalTok{    dcumInci3 =}\StringTok{ }\NormalTok{E3}\OperatorTok{*}\NormalTok{alpha;}
  \CommentTok{#age 59+}
\NormalTok{    dS4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{S3 }\OperatorTok{-}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{4}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{mu}\OperatorTok{*}\NormalTok{N;}
\NormalTok{    dE4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{E3 }\OperatorTok{+}\StringTok{ }\KeywordTok{sum}\NormalTok{(BETA[}\DecValTok{4}\NormalTok{,]}\OperatorTok{*}\KeywordTok{c}\NormalTok{(A1,A2,A3,A4))}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{beta1}\OperatorTok{*}\KeywordTok{cos}\NormalTok{(omega}\OperatorTok{*}\NormalTok{times))}\OperatorTok{*}\NormalTok{n[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{4}\NormalTok{]));}
\NormalTok{    dA4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{A3 }\OperatorTok{+}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{alpha}\OperatorTok{*}\NormalTok{theta[}\DecValTok{4}\NormalTok{] }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A4 }\OperatorTok{-}\StringTok{ }\NormalTok{mu}\OperatorTok{*}\NormalTok{A4;}
\NormalTok{    dM4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{M3 }\OperatorTok{+}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{(alpha}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta[}\DecValTok{4}\NormalTok{])) }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{M4 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{4}\NormalTok{])}\OperatorTok{*}\NormalTok{M4;}
\NormalTok{    dH4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{H3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{rho[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{M4 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4 }\OperatorTok{-}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4;}
\NormalTok{    dR4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{R3 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{A4 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{rho[}\DecValTok{4}\NormalTok{])}\OperatorTok{*}\NormalTok{M4 }\OperatorTok{+}\StringTok{ }\NormalTok{gamma_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4;}
\NormalTok{    dC4 =}\StringTok{ }\NormalTok{l3}\OperatorTok{*}\NormalTok{C3 }\OperatorTok{+}\StringTok{ }\NormalTok{kappa_h[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{H4 }\OperatorTok{-}\StringTok{ }\NormalTok{kappa_c[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4 }\OperatorTok{-}\StringTok{ }\NormalTok{sigma[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4;}
\NormalTok{    dDead4 =}\StringTok{ }\NormalTok{sigma[}\DecValTok{4}\NormalTok{]}\OperatorTok{*}\NormalTok{C4;}
\NormalTok{    dcumInci4 =}\StringTok{ }\NormalTok{E4}\OperatorTok{*}\NormalTok{alpha;}
    
          \CommentTok{# return the rate of change}
    \KeywordTok{list}\NormalTok{(}\KeywordTok{c}\NormalTok{(dS1, dS2, dS3, dS4, dE1, dE2, dE3, dE4, dA1, dA2, dA3, dA4, dM1, dM2, dM3, dM4, dH1, dH2, dH3, dH4, dR1, dR2, dR3, dR4, dC1, dC2, dC3, dC4, dDead1, dDead2, dDead3, dDead4, dcumInci1, dcumInci2,dcumInci3,dcumInci4))}
\NormalTok{  \}) }\CommentTok{# end with(as.list...)}
\NormalTok{\}}

\NormalTok{l1 =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\DecValTok{15}\OperatorTok{*}\DecValTok{365}\NormalTok{); }\CommentTok{#15 years}
\NormalTok{l2 =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\DecValTok{29}\OperatorTok{*}\DecValTok{365}\NormalTok{) }\CommentTok{#29 years}
\NormalTok{l3 =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\DecValTok{59}\OperatorTok{*}\DecValTok{365}\NormalTok{) }\CommentTok{#59 years}
\NormalTok{N=}\DecValTok{8500000}\NormalTok{;}
\NormalTok{n=}\KeywordTok{c}\NormalTok{(}\FloatTok{0.19}\NormalTok{, }\FloatTok{0.23}\NormalTok{, }\FloatTok{0.43}\NormalTok{, }\FloatTok{0.15}\NormalTok{);}
\NormalTok{A0=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{);}
\NormalTok{M0=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{);}
\NormalTok{E0=H0=cumInci0=C0=R0=Dead0=}\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{4}\NormalTok{);}
\NormalTok{S0=N}\OperatorTok{*}\NormalTok{n}\OperatorTok{-}\NormalTok{A0;}
  
\NormalTok{beta1 =}\StringTok{ }\FloatTok{1.12} \CommentTok{#peak infection}
\NormalTok{alpha =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\FloatTok{3.69} \CommentTok{#latent period}
\NormalTok{gamma =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\FloatTok{3.47} \CommentTok{#infectious period}
\NormalTok{rho =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.03}\NormalTok{,}\FloatTok{0.06}\NormalTok{,}\FloatTok{0.09}\NormalTok{,}\FloatTok{0.12}\NormalTok{) }\CommentTok{#proportion progressing to severe infection}
\NormalTok{mu =}\StringTok{ }\DecValTok{1}\OperatorTok{/}\NormalTok{(}\FloatTok{78.7}\OperatorTok{*}\DecValTok{365}\NormalTok{) }\CommentTok{#birth/death rate = 1/life expectancy in days}
\NormalTok{theta =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.95}\NormalTok{,}\FloatTok{0.9}\NormalTok{,}\FloatTok{0.85}\NormalTok{,}\FloatTok{0.8}\NormalTok{) }\CommentTok{#proportion asymptomatic}
\NormalTok{kappa_h =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.1}\OperatorTok{/}\DecValTok{11}\NormalTok{,}\FloatTok{0.13}\OperatorTok{/}\DecValTok{11}\NormalTok{,}\FloatTok{0.16}\OperatorTok{/}\DecValTok{13}\NormalTok{,}\FloatTok{0.19}\OperatorTok{/}\DecValTok{13}\NormalTok{) }\CommentTok{#proportion of severe to critical infection}
\NormalTok{gamma_h =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.9}\OperatorTok{/}\DecValTok{4}\NormalTok{,}\FloatTok{0.87}\OperatorTok{/}\DecValTok{4}\NormalTok{,}\FloatTok{0.84}\OperatorTok{/}\DecValTok{6}\NormalTok{,}\FloatTok{0.81}\OperatorTok{/}\DecValTok{6}\NormalTok{) }\CommentTok{#proportion of severe to recovered}
\NormalTok{kappa_c =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.35}\OperatorTok{/}\DecValTok{5}\NormalTok{,}\FloatTok{0.25}\OperatorTok{/}\DecValTok{5}\NormalTok{,}\FloatTok{0.15}\OperatorTok{/}\DecValTok{6}\NormalTok{,}\FloatTok{0.05}\OperatorTok{/}\DecValTok{6}\NormalTok{) }\CommentTok{#proportion of critical back to severe infection}
\NormalTok{sigma =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\FloatTok{0.65}\OperatorTok{/}\DecValTok{9}\NormalTok{,}\FloatTok{0.75}\OperatorTok{/}\DecValTok{9}\NormalTok{,}\FloatTok{0.85}\OperatorTok{/}\DecValTok{10}\NormalTok{,}\FloatTok{0.95}\OperatorTok{/}\DecValTok{10}\NormalTok{) }\CommentTok{#proportion of critical  to recovered}
\NormalTok{omega =}\StringTok{ }\DecValTok{2}\OperatorTok{*}\NormalTok{pi}\OperatorTok{/}\DecValTok{365} \CommentTok{#sinusoidal forcing}
\NormalTok{times=}\KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{365}\NormalTok{,}\DataTypeTok{by=}\DecValTok{1}\NormalTok{) }

\CommentTok{#beta matrix}
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.606148 4.803074 3.202049 2.401537
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.7}\OperatorTok{*}\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6.724304 3.362152 2.241435 1.681076
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\DecValTok{5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5055867 0.5336749 0.5650675 0.6003842
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\FloatTok{2.5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4.803074 2.401537 1.601025 1.200768
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FloatTok{0.7}\OperatorTok{*}\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\FloatTok{2.5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(}\DecValTok{1}\OperatorTok{-}\NormalTok{theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.3621518 1.6810759 1.1207173 0.8405379
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gamma}\OperatorTok{*}\NormalTok{(}\FloatTok{2.5}\OperatorTok{/}\DecValTok{3}\NormalTok{)}\OperatorTok{/}\NormalTok{(theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2527934 0.2668374 0.2825338 0.3001921
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{beta=}\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{4.80}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{0.84}\NormalTok{,}
              \FloatTok{1.68}\NormalTok{,}\FloatTok{2.40}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}
              \FloatTok{1.12}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.60}\NormalTok{,}\FloatTok{2.24}\NormalTok{,}
              \FloatTok{0.84}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{1.20}\NormalTok{),}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DataTypeTok{byrow=}\NormalTok{T)}
\NormalTok{Nmatrix=}\KeywordTok{diag}\NormalTok{(n,}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{);}
\NormalTok{r0=}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Nmatrix }\OperatorTok{%*%}\StringTok{ }\NormalTok{beta)}\OperatorTok{$}\NormalTok{values[}\DecValTok{1}\NormalTok{]}
\NormalTok{b =}\StringTok{ }\FloatTok{2.5}\OperatorTok{/}\NormalTok{r0}\OperatorTok{*}\NormalTok{gamma}
\NormalTok{BETA=}\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{4.80}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{0.84}\NormalTok{,}
              \FloatTok{1.68}\NormalTok{,}\FloatTok{2.40}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}
              \FloatTok{1.12}\NormalTok{,}\FloatTok{1.68}\NormalTok{,}\FloatTok{1.60}\NormalTok{,}\FloatTok{2.24}\NormalTok{,}
              \FloatTok{0.84}\NormalTok{,}\FloatTok{0.60}\NormalTok{,}\FloatTok{1.12}\NormalTok{,}\FloatTok{1.20}\NormalTok{),}\DecValTok{4}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DataTypeTok{byrow=}\NormalTok{T)}\OperatorTok{*}\NormalTok{b}

\NormalTok{state=}\KeywordTok{c}\NormalTok{(}\DataTypeTok{S1=}\NormalTok{S0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{S2=}\NormalTok{S0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{S3=}\NormalTok{S0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{S4=}\NormalTok{S0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{E1=}\NormalTok{E0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{E2=}\NormalTok{E0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{E3=}\NormalTok{E0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{E4=}\NormalTok{E0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{A1=}\NormalTok{A0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{A2=}\NormalTok{A0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{A3=}\NormalTok{A0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{A4=}\NormalTok{A0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{M1=}\NormalTok{A0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{M2=}\NormalTok{M0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{M3=}\NormalTok{M0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{M4=}\NormalTok{M0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{H1=}\NormalTok{A0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{H2=}\NormalTok{H0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{H3=}\NormalTok{H0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{H4=}\NormalTok{H0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{R1=}\NormalTok{R0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{R2=}\NormalTok{R0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{R3=}\NormalTok{R0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{R4=}\NormalTok{R0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{C1=}\NormalTok{C0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{C2=}\NormalTok{C0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{C3=}\NormalTok{C0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{C4=}\NormalTok{C0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{Dead1=}\NormalTok{Dead0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{Dead2=}\NormalTok{Dead0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{Dead3=}\NormalTok{Dead0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{Dead4=}\NormalTok{Dead0[}\DecValTok{4}\NormalTok{],}
        \DataTypeTok{cumInci1=}\NormalTok{cumInci0[}\DecValTok{1}\NormalTok{],}\DataTypeTok{cumInci2=}\NormalTok{cumInci0[}\DecValTok{2}\NormalTok{],}\DataTypeTok{cumInci3=}\NormalTok{cumInci0[}\DecValTok{3}\NormalTok{],}\DataTypeTok{cumInci4=}\NormalTok{cumInci0[}\DecValTok{4}\NormalTok{])}

\NormalTok{parameters=}\KeywordTok{c}\NormalTok{(}\DataTypeTok{BETA=}\NormalTok{BETA,}\DataTypeTok{mu=}\NormalTok{mu,}\DataTypeTok{gamma=}\NormalTok{gamma,}\DataTypeTok{alpha=}\NormalTok{alpha,}\DataTypeTok{rho=}\NormalTok{rho,}\DataTypeTok{theta=}\NormalTok{theta,}\DataTypeTok{kappa_h=}\NormalTok{kappa_h,}\DataTypeTok{gamma_h=}\NormalTok{gamma_h,}\DataTypeTok{kappa_c=}\NormalTok{kappa_c,}
             \DataTypeTok{sigma=}\NormalTok{sigma,}\DataTypeTok{omega=}\NormalTok{omega,}\DataTypeTok{N=}\NormalTok{N,}\DataTypeTok{beta1=}\NormalTok{beta1)    }
\end{Highlighting}
\end{Shaded}

\end{document}
